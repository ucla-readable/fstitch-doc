\section{Conclusion}
\label{sec:conclusion}

\Kudos\ \patches\ provide a new way for file system implementations to formalize
the ``write-before'' relationship among buffered changes to stable storage.
%
Thanks to several optimizations,
\begin{comment}
which significantly decrease the overhead
required to use \patches, both in terms of the amount of memory required and the
CPU time spent.
%
We evaluate a prototype file system implementation using \patches\ to determine
whether these ideas can be used in production file systems.
%
\end{comment}
the
performance of our prototype is usually at least as fast as Linux when
configured to provide similar consistency guarantees, although in some cases it
still requires improvement.
%
\Patches\ simplify the implementation of consistency mechanisms like journaling
and soft updates by separating the specification of write-before
relationships from their enforcement.
%
Using \patches\ also allows our prototype to be divided into \modules\ that
cooperate loosely to implement strong consistency guarantees.
%
Additionally, \patches\ can be extended into user space, allowing applications to
specify more precisely what their specific consistency requirements are.
%
This provides the buffer cache more freedom to reorder writes without violating
the application's needs, while simultaneously freeing the application from
having to micromanage writes to disk.
%
We present results for an IMAP server modified to take advantage of this
feature, and show that it can significantly reduce both the total time and the
number of writes required for our benchmark.


For future work, we plan to improve performance further, particularly for
system time; %
%% There are several areas in which we would like to improve our work. The obvious
%% first area we would like to work on is the performance of our \Kudos\ prototype.
%
we have already improved performance by at least five orders of magnitude
over the original implementation, but problems remain.
%
The \patch\ abstraction seems amenable to implementation elsewhere,
such as over network file systems, and was designed to implement other consistency
mechanisms like shadow paging.
%
Finally, we would like to adapt \patchgroups\ to more complicated
applications, like databases, to see how well they fit the needed semantics and
how well they perform.
