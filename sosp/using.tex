\section{Consistency Models}
\label{sec:using}

Soft updates, journaling, and other consistency models
correspond to different \patch\ arrangements.
%% , so these features can be added to
%% the system as \modules\ which appropriately connect or reconnect the \patches.
%
\Kudos's current file system \modules\ generate dependencies corresponding
to soft updates orderings by default~\cite{ganger00soft}.
%
Adding an independent journal \module\ rearranges the \patches\ to provide
journaling semantics.
%
%% for maximum speed and minimum durability, a \module\ that disconnects
%% \patch\ dependencies can be added.
%
%% Many other semantics could be supported by the addition of similar modules. In
%% this section, we will discuss how \patches\ are used to implement different
%% consistency semantics in \Kudos.

\input{softupdate}

\input{journal}

\paragraph{Asynchronous writes}
\label{sec:modules:unlink}

Finally, we also wrote a trivial module that removes all dependencies from
incoming \patches, allowing the buffer cache to write blocks in any order.
%
This implements similar semantics to existing file systems like ext2 in
asynchronous write mode.

%% In the event that no consistency semantics are desired, for instance to compare
%% a prototype implementation of a system for working with explicit dependency
%% information to an existing asynchronous file system like ext2, \Kudos\ provides
%% a \module\ which unlinks the dependencies from all \patches\ passing through it.
%% By using this \module, the \patch\ graph will not enforce any ordering at all,
%% and the buffer cache will be free to write blocks in any order. \Patches\ are
%% not really necessary to implement this ``consistency'' protocol, but they
%% nevertheless support it as a degenerate case.
